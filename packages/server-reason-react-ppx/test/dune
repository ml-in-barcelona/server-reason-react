(test
 (name test)
 ; This flag is useful to ensure that the ppx doesn't use the auto-opened Stdlib, can't be kept in the dune because it propagates to all the dependencies
 ; (flags -nopervasives)
 (libraries
  alcotest
  lwt
  yojson
  melange-json-native
  server-reason-react.react
  server-reason-react.reactDom
  server-reason-react.js
  unix
  alcotest-lwt)
 (preprocess
  (pps
   server-reason-react.ppx
   -shared-folder-prefix=doesnt-matter
   server-reason-react.melange_ppx
   lwt_ppx
   melange-json.ppx)))
